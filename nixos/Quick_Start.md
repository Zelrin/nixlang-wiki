---
title: NixOS Quick Start
description: 
published: true
date: 2023-12-01T16:35:07.891Z
tags: 
editor: markdown
dateCreated: 2023-11-30T06:17:25.306Z
---

# NixOS Quick Start

## Installation

ISO image, VirtualBox, or Amaxon EC2:
- https://nixos.org/download.html
  
On a Virtual Private Server (like a DigitalOcean Droplet):
- NixOS-Infect: https://github.com/elitak/nixos-infect
  
  - (Be sure to use `export doNetConf=y` before running the script ([bug page](https://github.com/elitak/nixos-infect/issues/164)))
  
## Configuration Files

A common structure is to put all of your nix configuration files in a git repository to keep track of them, and then symlink them to where they are used.

A script setting up these symlinks could look like this:

```bash
#!/usr/bin/env bash

# NOTE: probably needs to be run with sudo or as root

ln -sf $(realpath configuration.nix) /etc/nixos/
```

The core configuration file is `configuration.nix`

Here's a relatively minimal example (\<things in angle brackets\> should be replaced before use):

```nix
{ pkgs, config, ... }:
{
  imports = [
    ./hardware-configuration.nix # generated by nixos-infect
    ./networking.nix # generated by nixos-infect
    <home-manager/nixos>
  ];

  # https://nixos.wiki/wiki/FAQ/When_do_I_update_stateVersion
  system.stateVersion = "23.05";

  boot.tmp.cleanOnBoot = true;
  zramSwap.enable = true;
  networking.hostName = <host name>;
  networking.domain = "";
  services.openssh = {
    enable = true;
    settings.PasswordAuthentication = false;
  };

  users.defaultUserShell = pkgs.zsh;
  environment.shells = [ pkgs.zsh ];

  security.sudo = {
    enable = true;
    wheelNeedsPassword = true;
  };

  networking.firewall = {
    enable = true;
    interfaces."ssh".allowedTCPPorts = [ 22 ]; 
  };

  nix.settings = {
    auto-optimise-store = true;
    experimental-features = [ "nix-command" "flakes" ];
  };

  time.timeZone = "America/Vancouver";

  users.mutableUsers = false;
  users.users = {
    root.openssh.authorizedKeys.keys = [ <REDACTED> ];
    <username> = {
      isNormalUser = true;
      home = "/home/<username>";
      extraGroups = [ "wheel" ];
      openssh.authorizedKeys.keys = [ <REDACTED> ];

      hashedPassword = <REDACTED>;
    };
  };
  
  environment.systemPackages = with pkgs; [
    mkpasswd
    ripgrep # grep replacement
    chafa # display images in terminal
    tealdeer # for tldr
    htop
    bottom # htop replacement (works in very small terminal windows)
    btop # htop replacement (really nice TUI)
    fd # find replacement
    zoxide # cd replacement
    sd # sed find-replace replacement
    vitetris # tetris
    nil # nix language server
    python3
    config.boot.kernelPackages.perf
    p7zip
  ];

  programs = { zsh.enable = true; };

  # Separating the home manager configuration like this allows the same home manager configuration to be used on NixOS and systems with standalone Nix.
  home-manager.users.<username> = import ./home.nix; 

}

```

### Home Manager

Set up a `home.nix` file for managing installed programs and dotfiles: [home-manager](/nix/home-manager)
