<!--
title: NixOS Quick Start
description: 
published: true
date: 2023-12-29T21:30:16.618Z
tags: 
editor: ckeditor
dateCreated: 2023-11-30T06:17:25.306Z
-->

<h1 class="toc-header" id="nixos-quick-start"> NixOS Quick Start</h1>
<h2 class="toc-header" id="installation"> Installation</h2>
<p>ISO image, VirtualBox, or Amaxon EC2:</p>
<ul>
<li><a class="is-external-link" href="https://nixos.org/download.html">https://nixos.org/download.html</a></li>
</ul>
<p>On a Virtual Private Server (like a DigitalOcean Droplet):</p>
<ul>
<li>
<p>NixOS-Infect: <a class="is-external-link" href="https://github.com/elitak/nixos-infect">https://github.com/elitak/nixos-infect</a></p>
<ul>
<li>(Be sure to use <code>export doNetConf=y</code> before running the script (<a class="is-external-link" href="https://github.com/elitak/nixos-infect/issues/164">bug page</a>))</li>
</ul>
</li>
</ul>
<h2 class="toc-header" id="configuration-files"> Configuration Files</h2>
<p>A common structure is to put all of your nix configuration files in a git repository to keep track of them, and then symlink them to where they are used.</p>
<p>A script setting up these symlinks could look like this:</p>
<pre v-pre="true" class="prismjs line-numbers"><code class="language-bash">#!/usr/bin/env bash

# NOTE: probably needs to be run with sudo or as root

ln -sf $(realpath configuration.nix) /etc/nixos/
</code></pre>
<p>The core configuration file is <code>configuration.nix</code></p>
<p>Here's a relatively minimal example (&lt;&lt;things in double angle brackets&gt;&gt; should be replaced before use):</p>
<pre v-pre="true" class="prismjs line-numbers"><code class="language-nix">{ pkgs, config, ... }:
{
  imports = [
    ./hardware-configuration.nix # generated by nixos-infect
    ./networking.nix # generated by nixos-infect
    &lt;home-manager/nixos&gt;
  ];

  # https://nixos.wiki/wiki/FAQ/When_do_I_update_stateVersion
  system.stateVersion = "23.05";

  boot.tmp.cleanOnBoot = true;
  zramSwap.enable = true;
  networking.hostName = &lt;&lt;host name&gt;&gt;;
  networking.domain = "";
  services.openssh = {
    enable = true;
    settings.PasswordAuthentication = false;
  };

  users.defaultUserShell = pkgs.zsh;
  environment.shells = [ pkgs.zsh ];

  security.sudo = {
    enable = true;
    wheelNeedsPassword = true;
  };

  networking.firewall = {
    enable = true;
    interfaces."ssh".allowedTCPPorts = [ 22 ]; 
  };

  nix.settings = {
    auto-optimise-store = true;
    experimental-features = [ "nix-command" "flakes" ];
  };

  time.timeZone = "America/Vancouver";

  users.mutableUsers = false;
  users.users = {
    root.openssh.authorizedKeys.keys = [ &lt;&lt;REDACTED&gt;&gt; ];
    &lt;&lt;username&gt;&gt; = {
      isNormalUser = true;
      home = "/home/&lt;&lt;username&gt;&gt;";
      extraGroups = [ "wheel" ];
      openssh.authorizedKeys.keys = [ &lt;&lt;REDACTED&gt;&gt; ];

      hashedPassword = &lt;&lt;REDACTED&gt;&gt;;
    };
  };
  
  environment.systemPackages = with pkgs; [
    mkpasswd
    ripgrep # grep replacement
    chafa # display images in terminal
    tealdeer # for tldr
    htop
    bottom # htop replacement (works in very small terminal windows)
    btop # htop replacement (really nice TUI)
    fd # find replacement
    zoxide # cd replacement
    sd # sed find-replace replacement
    vitetris # tetris
    nil # nix language server
    python3
    config.boot.kernelPackages.perf
    p7zip
  ];

  programs = { zsh.enable = true; };

  # Separating the home manager configuration like this allows the same home manager configuration to be used on NixOS and systems with standalone Nix.
  home-manager.users.&lt;&lt;username&gt;&gt; = import ./home.nix; 

}

</code></pre>
<h3 class="toc-header" id="home-manager"> Home Manager</h3>
<p>Set up a <code>home.nix</code> file for managing installed programs and dotfiles: <a class="is-internal-link is-valid-page" href="/nix/home-manager">home-manager</a></p>
